
import cx_Oracle
import pandas as pd
from pandas import DataFrame
import numpy as np
import string

connection = cx_Oracle.connect('nagappa/Welcome!23@bidbdev04-dur.corp.netapp.com/dedwni04')


query = """SELECT /*+ parallel(T762683, 6) */
        T762683.SITE_COUNTRY_NAME AS DISTRIBUTOR_SITE_COUNTRY_NAME,
         COUNT (DISTINCT BK_SALES_ORDER_NUMBER) AS HUNDRED_PCT_PVR
    FROM DIMS.ORGANIZATION_PARTY T762683,
         DIMS.QUOTE T762071,
         DIMS.ENTERPRISE_LIST_OF_VALUES T705584,
         FACTS.SALES_BOOKING T762157,
         DIMS.CALENDAR T763102,
         DIMS.SALES_ORDER T762251
   WHERE (    T762157.DISTRIBUTOR_AS_IS_KEY = T762683.ORGANIZATION_PARTY_KEY
          AND T705584.ATTRIBUTE_CODE = 'CORP FLAG'
          AND T705584.ATTRIBUTE_CODE_VALUE = T762157.CORP_FLAG
          AND T762157.SOURCE_TRANSACTION_DATE_KEY = T763102.DATE_KEY
          AND T762071.QUOTE_KEY = T762157.QUOTE_KEY
          AND T705584.ATTRIBUTE_CODE_DESCRIPTION = 'Y'
          AND T762157.SALES_ORDER_KEY = T762251.SALES_ORDER_KEY
          AND (T763102.FISCAL_YEAR_QTR_TEXT = '2019Q2')
          AND T762071.HUNDRED_PCT_DISC_REASON_NAME IS NOT NULL
          AND T762157.ME_EXT_LIST_PRICE <> '0')
GROUP BY T762683.SITE_COUNTRY_NAME """

df_ora = pd.read_sql(query, connection)

print df_ora

